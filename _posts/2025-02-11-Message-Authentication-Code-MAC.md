---
title: "Message Authentication Code (MAC)"
date: "2025-02-10 00:00:00 +0900"
categories: [Knowledge, Encryption]
tags: [Digital Signaturte, CA]
---

# Message Authentication Code / MAC

## 1. メッセージ認証符号(MAC)とは

- `メッセージ認証符号(MAC)`: メッセージの完全性を保証するための仕組み
  - `完全性(Integrity)`: 情報が正確かつ完全な状態に保たれていること。情報が改ざんや破壊されず、正しい情報のまま維持されている状態を指す

## 2. メッセージ認証符号(MAC)の作成方法

- MACの生成方法の1つであるHMAC(Hash based Message Authentication Code)
　　- データの完全性とメッセージ認証を同時に検証できる。
- HMACの仕組み：
  - お互いが共通して持っている`秘密鍵`と`メッセージ`を`ハッシュ関数`に渡して`MAC値`を生成
- 流れ：
  - `MAC値`と`メッセージ`を相手に送る
  - ![alt text](../assets/images/Screenshot_2025-02-11_1.png)
## 3. メッセージ認証符号(MAC)は作成者を判断できない

- メッセージの作成者を特定することはできない。
- つまり、送信者か受信者のどちらがメッセージを作成したのか分からない。
  - 両者とも同じ秘密鍵を持っているため。
- もし作成者を担保したい場合：`公開鍵暗号方式`を使った`デジタル署名`を利用する必要がある。

## 参照

- [メッセージ認証符号 - MAC](https://www.youtube.com/watch?v=OzGi7aB1fN0)




























## サーバー証明書が発行されるまで

- サーバー証明書発行依頼（サーバー → 認証局）
  - どんなサーバーでどんな公開鍵を使うかなどの情報を渡す
- サーバー証明書を作成（認証局）
  - X.509で規定されたフォーマット通りに作成
  - 内容(=署名前証明書):
    - シリアル番号
    - 署名アルゴリズム
    - 発行者(認証局)
    - 有効期限
    - 発行対象(企業)
    - 発行対象の公開鍵
  - この署名前証明書を使って署名アルゴリズムで書かれた方法でハッシュ値を取得
  - このハッシュ値を認証局の秘密鍵を使って暗号化
  - この暗号化されたデータが認証局の署名(=デジタル署名)となる
  - この書類認証局の秘密鍵によって暗号化されているので、認証局の公開鍵を使って復号するとハッシュ値が出てくる。
- 作成された証明書はサーバー管理者に送られ、サーバーに格納される
- クライアントが接続してきたときにサーバー証明書を送る
- クライアントはこのサーバー証明書を認証局の公開鍵を用いて検証する
  - 公開鍵を用いてデジタル署名を復号 → 署名前証明書のハッシュ値が出てくる
  - クライアントは署名前証明書を署名アルゴリズムによって計算し、ハッシュ値を求める
  - この2つのハッシュ値を比べて正当性を確かめる。（もし同じなら、認証局の署名であると確定）
- サーバー証明書には接続先のサーバーの情報が入っており、Webサーバーの公開鍵の情報も入っているので、この公開鍵を使って接続先のサーバーと暗号通信できる(TLSハンドシェイク)


## 参照

- [デジタル署名と電子認証とは](https://www.youtube.com/watch?v=S5jJJAGC5vs)：〇
- [デジタル証明書 - 概要](https://www.youtube.com/watch?v=O1T2-rziJ_c) :〇
- [デジタル証明書 - 補足1](https://www.youtube.com/watch?v=iwbGqXWA_ys)
- [デジタル証明書の検証方法](https://www.youtube.com/watch?v=p7oVTL0BrYs)
- [図解 X.509 証明書](https://qiita.com/TakahikoKawasaki/items/4c35ac38c52978805c69)
- [HTTPS(SSL/TLS)図解で分かる！](https://www.youtube.com/watch?v=nH70Ph3RxZg)